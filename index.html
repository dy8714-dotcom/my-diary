<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒã‚¤æ—¥è¨˜å¸³</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Sans JP', sans-serif; background: #f5f5f5; }
        header { background: white; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .header-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
        h1 { font-size: 24px; cursor: pointer; color: #333; }
        .header-actions { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .search-group { display: flex; gap: 5px; }
        .btn { padding: 8px 16px; border: 1px solid #ddd; background: white; border-radius: 4px; cursor: pointer; font-size: 14px; transition: all 0.3s ease; }
        .btn:hover { background: #f0f0f0; }
        .btn-new { background: #4a90e2; color: white; border-color: #4a90e2; }
        .btn-new:hover { background: #357abd; }
        .btn-search { background: #4a90e2; color: white; border-color: #4a90e2; padding: 8px 12px; }
        .container { max-width: 1400px; margin: 20px auto; padding: 0 20px; display: flex; gap: 30px; }
        .main-content { flex: 1; min-width: 0; }
        
        .year-tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .year-tab { padding: 10px 20px; background: white; border: 2px solid #ddd; border-radius: 4px; cursor: pointer; transition: all 0.3s ease; }
        .year-tab:hover { border-color: #4a90e2; }
        .year-tab.active { background: #4a90e2; color: white; border-color: #4a90e2; }
        
        .months-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; margin-bottom: 30px; }
        .month-box { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-top: 4px solid; }
        .month-box:nth-child(1) { border-top-color: #ff6b6b; }
        .month-box:nth-child(2) { border-top-color: #ee5a6f; }
        .month-box:nth-child(3) { border-top-color: #c44569; }
        .month-box:nth-child(4) { border-top-color: #786fa6; }
        .month-box:nth-child(5) { border-top-color: #4a69bd; }
        .month-box:nth-child(6) { border-top-color: #0fbcf9; }
        .month-box:nth-child(7) { border-top-color: #00d2d3; }
        .month-box:nth-child(8) { border-top-color: #7bed9f; }
        .month-box:nth-child(9) { border-top-color: #feca57; }
        .month-box:nth-child(10) { border-top-color: #ff9ff3; }
        .month-box:nth-child(11) { border-top-color: #ff6348; }
        .month-box:nth-child(12) { border-top-color: #ff4757; }
        
        .month-header { font-size: 14px; font-weight: 600; margin-bottom: 12px; text-align: center; color: #333; }
        .date-list { display: flex; flex-direction: column; gap: 6px; }
        .date-item { padding: 6px 8px; background: #f9f9f9; border-radius: 4px; font-size: 11px; transition: all 0.3s ease; }
        .date-item.has-entry { background: #e8f4ff; border-left: 3px solid #4a90e2; cursor: pointer; }
        .date-item.has-entry:hover { background: #d0e8ff; transform: translateX(2px); }
        .date-item.no-entry { background: #fafafa; color: #ccc; cursor: default; }
        .date-label { font-weight: 500; font-size: 10px; }
        .date-item.has-entry .date-label { color: #333; }
        .date-item.no-entry .date-label { color: #ccc; }
        .date-title { color: #333; margin-top: 2px; font-size: 11px; }
        .show-more-btn { margin-top: 10px; padding: 6px; background: #f0f0f0; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-size: 11px; transition: all 0.3s ease; }
        .show-more-btn:hover { background: #e0e0e0; }
        
        .sidebar { width: 300px; position: sticky; top: 100px; height: fit-content; }
        .sidebar-section { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .sidebar-title { font-size: 16px; font-weight: 600; margin-bottom: 15px; }
        .profile { text-align: center; }
        .profile-img { width: 80px; height: 80px; border-radius: 50%; margin: 0 auto 10px; cursor: pointer; transition: all 0.3s ease; object-fit: cover; }
        .profile-img:hover { transform: scale(1.05); }
        .profile-name { font-size: 16px; font-weight: 600; margin-bottom: 5px; cursor: pointer; transition: color 0.3s ease; }
        .profile-name:hover { color: #4a90e2; }
        .profile-bio { font-size: 12px; color: #666; }
        
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .calendar-nav button { background: none; border: none; cursor: pointer; font-size: 16px; padding: 5px; transition: color 0.3s ease; }
        .calendar-nav button:hover { color: #4a90e2; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 11px; border-radius: 4px; background: #f9f9f9; transition: all 0.3s ease; }
        .calendar-day.has-entry { background: #4a90e2; color: white; font-weight: 600; cursor: pointer; }
        .calendar-day.has-entry:hover { background: #357abd; }
        .calendar-day.other-month { opacity: 0.3; cursor: default; }
        
        .entry-list { display: flex; flex-direction: column; gap: 10px; }
        .entry-item { padding: 10px; background: #f9f9f9; border-radius: 4px; cursor: pointer; transition: all 0.3s ease; }
        .entry-item:hover { background: #e8f4ff; transform: translateX(2px); }
        .entry-date { font-size: 10px; color: #999; margin-bottom: 3px; }
        .entry-title { font-size: 13px; color: #333; font-weight: 500; }
        .view-more { display: block; text-align: center; padding: 10px; background: #f0f0f0; border-radius: 4px; color: #666; text-decoration: none; margin-top: 10px; font-size: 13px; cursor: pointer; transition: all 0.3s ease; }
        .view-more:hover { background: #e0e0e0; }
        
        .page-container { background: white; border-radius: 8px; padding: 30px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .article-nav { display: flex; justify-content: space-between; margin-bottom: 20px; gap: 10px; flex-wrap: wrap; }
        .nav-link { padding: 10px 15px; background: #f0f0f0; border-radius: 4px; text-decoration: none; color: #333; font-size: 14px; transition: all 0.3s ease; }
        .nav-link:hover { background: #e0e0e0; }
        .article-header { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
        .article-title { font-size: 28px; font-weight: 600; margin-bottom: 10px; color: #333; }
        .article-meta { display: flex; gap: 15px; color: #666; font-size: 14px; flex-wrap: wrap; align-items: center; }
        .article-content { line-height: 1.8; font-size: 16px; margin-bottom: 30px; color: #333; }
        .article-content p { margin-bottom: 15px; }
        .article-content img { width: 100%; border-radius: 8px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .article-tags { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 20px; }
        .tag { padding: 5px 12px; background: #f0f0f0; border-radius: 20px; font-size: 12px; color: #666; }
        
        .comments-section { margin-top: 40px; padding-top: 30px; border-top: 2px solid #eee; }
        .comments-title { font-size: 20px; font-weight: 600; margin-bottom: 20px; }
        .comment-form textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; resize: vertical; min-height: 80px; margin-bottom: 10px; font-family: inherit; }
        .comment-item { padding: 15px; background: #f9f9f9; border-radius: 4px; margin-bottom: 10px; }
        .comment-meta { color: #999; font-size: 12px; margin-bottom: 5px; }
        .comment-text { color: #333; font-size: 14px; line-height: 1.6; }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #333; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; font-family: inherit; }
        .form-group textarea { min-height: 200px; resize: vertical; line-height: 1.6; }
        .form-actions { display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap; }
        .image-preview-container { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
        .image-preview-item { position: relative; width: 100px; height: 100px; }
        .image-preview-item img { width: 100%; height: 100%; object-fit: cover; border-radius: 4px; }
        .image-remove { position: absolute; top: -5px; right: -5px; background: #ff4757; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; line-height: 1; }
        
        .articles-list { display: flex; flex-direction: column; gap: 20px; }
        .article-card { background: white; border-radius: 8px; padding: 20px; display: flex; gap: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); cursor: pointer; transition: all 0.3s ease; }
        .article-card:hover { box-shadow: 0 4px 8px rgba(0,0,0,0.15); transform: translateY(-2px); }
        .article-thumbnail { width: 120px; height: 120px; border-radius: 4px; object-fit: cover; flex-shrink: 0; }
        .article-info { flex: 1; min-width: 0; }
        .article-list-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; color: #333; }
        .article-excerpt { font-size: 14px; color: #666; margin-bottom: 8px; }
        
        .pagination { display: flex; justify-content: center; gap: 8px; margin-top: 30px; flex-wrap: wrap; }
        .page-btn { min-width: 35px; height: 35px; padding: 0 10px; border: 1px solid #ddd; background: white; border-radius: 4px; cursor: pointer; transition: all 0.3s ease; }
        .page-btn:hover { background: #f0f0f0; }
        .page-btn.active { background: #4a90e2; color: white; border-color: #4a90e2; }
        
        .profile-content { display: flex; gap: 40px; margin-bottom: 30px; flex-wrap: wrap; }
        .profile-image-section { text-align: center; }
        .profile-large-img { width: 200px; height: 200px; border-radius: 50%; margin-bottom: 15px; object-fit: cover; }
        .profile-details { flex: 1; min-width: 300px; }
        .profile-name-large { font-size: 24px; font-weight: 600; margin-bottom: 20px; }
        .profile-item { display: flex; padding: 10px 0; border-bottom: 1px solid #eee; }
        .profile-label { width: 140px; color: #666; font-weight: 500; }
        .profile-value { flex: 1; color: #333; }
        
        .hidden { display: none !important; }
        
        @media (max-width: 1200px) {
            .months-grid { grid-template-columns: repeat(4, 1fr); }
        }
        
        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .sidebar { width: 100%; position: static; }
            .months-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1 onclick="showDashboard()">ãƒã‚¤æ—¥è¨˜å¸³</h1>
            <div class="header-actions">
                <div class="search-group">
                    <input type="text" id="searchInput" placeholder="è¨˜äº‹ã‚’æ¤œç´¢..." style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; width: 180px;">
                    <button class="btn btn-search" onclick="searchArticles()">ğŸ” æ¤œç´¢</button>
                </div>
                <button class="btn btn-new" onclick="showNewArticle()">âœï¸ æ–°è¦è¨˜äº‹</button>
                <button class="btn" onclick="exportData()">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                <button class="btn" onclick="importData()">ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
            </div>
        </div>
    </header>

    <div class="container">
        <main class="main-content">
            <div id="dashboard"></div>
            <div id="articlePage" class="hidden"></div>
            <div id="editPage" class="hidden"></div>
            <div id="listPage" class="hidden"></div>
            <div id="profilePage" class="hidden"></div>
        </main>

        <aside class="sidebar">
            <div class="sidebar-section profile">
                <img src="https://via.placeholder.com/100" alt="Profile" class="profile-img" onclick="showProfilePage()">
                <div class="profile-name" onclick="showProfilePage()">å±±ç”° èŠ±å­</div>
                <div class="profile-bio">æ¯æ—¥ã‚’å¤§åˆ‡ã«è¨˜éŒ²ã—ã¦ã„ã¾ã™</div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</div>
                <div class="calendar-header">
                    <span id="calendarMonth"></span>
                    <div class="calendar-nav">
                        <button onclick="prevMonth()">â—€</button>
                        <button onclick="nextMonth()">â–¶</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">New Entry</div>
                <div class="entry-list" id="newEntryList"></div>
                <div class="view-more" onclick="showArticlesList()">View More</div>
            </div>
        </aside>
    </div>

    <input type="file" id="importFile" accept=".json" style="display:none;">

    <script>
        let articles = {};
        let profile = {
            name: 'å±±ç”° èŠ±å­',
            birthday: '1995-05-15',
            bloodType: 'A',
            zodiac: 'ãŠã†ã—åº§',
            height: '160',
            photo: 'https://via.placeholder.com/200',
            custom: [
                { label: 'è¶£å‘³', value: 'èª­æ›¸ã€éŸ³æ¥½é‘‘è³' },
                { label: 'å¥½ããªé£Ÿã¹ç‰©', value: 'ã‚¤ãƒã‚´' },
                { label: 'åº§å³ã®éŠ˜', value: 'ä¸€æœŸä¸€ä¼š' }
            ]
        };
        let currentYear = 2026;
        let currentMonth = 0;
        let editImages = [];
        let editThumbnail = '';
        let editBlocks = []; // ãƒ–ãƒ­ãƒƒã‚¯ã‚¨ãƒ‡ã‚£ã‚¿ç”¨
        
        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆé–¢æ•°
        function generateSampleData() {
            const titles = [
                'æ–°å¹´ã®æŠ±è² ', 'ä»Šæ—¥ã®ã‚«ãƒ•ã‚§å·¡ã‚Š', 'å‹é”ã¨ãƒ©ãƒ³ãƒ', 'é€±æœ«ã®éã”ã—æ–¹', 
                'æ˜ ç”»é‘‘è³ã®æ„Ÿæƒ³', 'ç¾è¡“é¤¨ã«è¡Œã£ã¦ããŸ', 'ãŠæ°—ã«å…¥ã‚Šã®ã‚«ãƒ•ã‚§', 'ä»Šæ—¥ã®æ–™ç†',
                'ãƒ¨ã‚¬å§‹ã‚ã¾ã—ãŸ', 'æ¡œãŒç¶ºéº—ã ã£ãŸ', 'æ–°ã—ã„è¶£å‘³ç™ºè¦‹', 'èª­æ›¸ã®è¨˜éŒ²',
                'éŸ³æ¥½ã‚’è´ããªãŒã‚‰', 'æ•£æ­©æ—¥å’Œ', 'ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°æ—¥è¨˜', 'ä»Šæ—¥ã®æ°—åˆ†',
                'æ€ã„å‡ºã®å†™çœŸ', 'å­£ç¯€ã®å¤‰ã‚ã‚Šç›®', 'å¹¸ã›ãªä¸€æ—¥', 'å°ã•ãªç™ºè¦‹',
                'æ—¥å¸¸ã®é¢¨æ™¯', 'ç™’ã—ã®æ™‚é–“', 'å¤§åˆ‡ãªæ™‚é–“', 'å¿ƒã«æ®‹ã‚‹å‡ºæ¥äº‹',
                'ä»Šæ—¥ã®ã‚ã‚ŠãŒã¨ã†', 'ç´ æ•µãªå‡ºä¼šã„', 'æ–°ã—ã„æŒ‘æˆ¦', 'è‡ªåˆ†ç£¨ã',
                'ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥', 'ç©ã‚„ã‹ãªæ™‚é–“', 'å……å®Ÿã®ä¸€æ—¥', 'æ¥½ã—ã„äºˆå®š',
                'æ€ã‚ã¬ç™ºè¦‹', 'å¿ƒæ¸©ã¾ã‚‹å‡ºæ¥äº‹', 'ä»Šå¹´ã®ç›®æ¨™', 'å¤‰åŒ–ã®å…†ã—',
                'å‰å‘ããªæ°—æŒã¡', 'æ„Ÿè¬ã®æ°—æŒã¡', 'æ˜æ—¥ã¸ã®æœŸå¾…', 'ä»Šæ—¥ã‚‚é ‘å¼µã£ãŸ'
            ];
            
            const contents = [
                'ä»Šæ—¥ã¯ã¨ã¦ã‚‚è‰¯ã„å¤©æ°—ã§ã—ãŸã€‚æœã‹ã‚‰æ°—åˆ†ãŒè‰¯ãã¦ã€ã„ã¤ã‚‚ã‚ˆã‚Šæ—©èµ·ãã§ãã¾ã—ãŸã€‚æœé£Ÿã‚‚ã‚†ã£ãã‚Šæ¥½ã—ã‚ã¦ã€å¹¸ã›ãªä¸€æ—¥ã®å§‹ã¾ã‚Šã§ã™ã€‚\n\nã“ã‚“ãªæ—¥ã¯å¤–ã«å‡ºã‹ã‘ãŸããªã‚Šã¾ã™ã­ã€‚è¿‘æ‰€ã‚’æ•£æ­©ã—ãªãŒã‚‰ã€å­£ç¯€ã®å¤‰åŒ–ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚å°ã•ãªå¹¸ã›ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹æ—¥ã€…ã«æ„Ÿè¬ã§ã™ã€‚',
                'ä¹…ã—ã¶ã‚Šã«å‹é”ã¨ä¼šã£ã¦ã€ãŸãã•ã‚“è©±ã‚’ã—ã¾ã—ãŸã€‚ãŠäº’ã„ã®è¿‘æ³ã‚’å ±å‘Šã—åˆã£ã¦ã€æ˜”è©±ã«ã‚‚èŠ±ãŒå’²ãã¾ã—ãŸã€‚\n\nã“ã†ã„ã†æ™‚é–“ã£ã¦æœ¬å½“ã«å¤§åˆ‡ã ãªã¨æ”¹ã‚ã¦æ„Ÿã˜ã¾ã—ãŸã€‚ã¾ãŸè¿‘ã„ã†ã¡ã«ä¼šã†ç´„æŸã‚’ã—ã¦ã€ä»Šæ—¥ã¯æ¥½ã—ã„ä¸€æ—¥ã§ã—ãŸã€‚',
                'æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦ã—ã¦ã¿ã¾ã—ãŸã€‚æœ€åˆã¯ä¸å®‰ã‚‚ã‚ã‚Šã¾ã—ãŸãŒã€ã‚„ã£ã¦ã¿ã‚‹ã¨æ„å¤–ã¨æ¥½ã—ãã¦ã€ã‚‚ã£ã¨ç¶šã‘ãŸã„ã¨æ€ã„ã¾ã—ãŸã€‚\n\nä½•äº‹ã‚‚ã‚„ã£ã¦ã¿ãªã„ã¨ã‚ã‹ã‚‰ãªã„ã‚‚ã®ã§ã™ã­ã€‚ã“ã‚Œã‹ã‚‰ã‚‚è‰²ã€…ãªã“ã¨ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã„ããŸã„ã§ã™ã€‚'
            ];
            
            const categories = ['æ—¥å¸¸', 'ãŠå‡ºã‹ã‘', 'è¶£å‘³', 'é£Ÿäº‹', 'å‹é”', 'ä»•äº‹', 'å¥åº·'];
            const tagsList = [
                ['æ—¥å¸¸', 'æ€ã„å‡º'],
                ['ã‚«ãƒ•ã‚§', 'ã‚°ãƒ«ãƒ¡'],
                ['å‹é”', 'æ¥½ã—ã„'],
                ['è¶£å‘³', 'æ–°ç™ºè¦‹'],
                ['æ˜ ç”»', 'ã‚¨ãƒ³ã‚¿ãƒ¡'],
                ['ã‚¢ãƒ¼ãƒˆ', 'ç¾è¡“é¤¨'],
                ['æ–™ç†', 'æ‰‹ä½œã‚Š'],
                ['å¥åº·', 'é‹å‹•'],
                ['èª­æ›¸', 'æœ¬'],
                ['éŸ³æ¥½', 'ãƒªãƒ©ãƒƒã‚¯ã‚¹']
            ];
            
            // 2026å¹´ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ30ä»¶ï¼‰
            const dates2026 = [
                // 1æœˆ: 8ä»¶
                '2026-01-01', '2026-01-03', '2026-01-05', '2026-01-08', 
                '2026-01-10', '2026-01-15', '2026-01-18', '2026-01-25',
                // 2æœˆ: 7ä»¶
                '2026-02-02', '2026-02-05', '2026-02-08', '2026-02-10', 
                '2026-02-14', '2026-02-20', '2026-02-28',
                // 3æœˆ: 5ä»¶
                '2026-03-03', '2026-03-08', '2026-03-12', '2026-03-18', '2026-03-25',
                // 4æœˆ: 3ä»¶
                '2026-04-05', '2026-04-12', '2026-04-20',
                // 5æœˆ: 3ä»¶
                '2026-05-03', '2026-05-15', '2026-05-28',
                // 6æœˆ: 2ä»¶
                '2026-06-10', '2026-06-22',
                // 7æœˆ: 2ä»¶
                '2026-07-07', '2026-07-21'
            ];
            
            // 2025å¹´ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ10ä»¶ï¼‰
            const dates2025 = [
                // 12æœˆ: 5ä»¶
                '2025-12-03', '2025-12-10', '2025-12-15', '2025-12-25', '2025-12-31',
                // 11æœˆ: 3ä»¶
                '2025-11-05', '2025-11-15', '2025-11-28',
                // 10æœˆ: 2ä»¶
                '2025-10-10', '2025-10-25'
            ];
            
            const allDates = [...dates2026, ...dates2025];
            
            allDates.forEach((date, i) => {
                const hour = 9 + Math.floor(Math.random() * 12);
                const minute = Math.floor(Math.random() * 60);
                const timestamp = new Date(date + `T${String(hour).padStart(2,'0')}:${String(minute).padStart(2,'0')}:00`).getTime();
                
                articles[date] = {
                    title: titles[i % titles.length],
                    content: contents[i % contents.length],
                    timestamp: timestamp,
                    images: [
                        `https://picsum.photos/800/600?random=${i}a`,
                        `https://picsum.photos/800/600?random=${i}b`
                    ],
                    thumbnail: `https://picsum.photos/400/400?random=${i}`,
                    tags: tagsList[i % tagsList.length],
                    category: categories[i % categories.length],
                    status: 'published',
                    comments: (i % 5 === 0) ? [{
                        text: 'ã“ã®æ—¥ã®ã“ã¨ã¯ä»Šã§ã‚‚è¦šãˆã¦ã„ã¾ã™ã€‚ç´ æ•µãªä¸€æ—¥ã§ã—ãŸã­ã€‚',
                        timestamp: timestamp + 3600000
                    }] : []
                };
            });
            
            console.log('ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã—ãŸ:', Object.keys(articles).length, 'ä»¶');
        }
        
        // åˆæœŸåŒ–
        function init() {
            console.log('åˆæœŸåŒ–é–‹å§‹...');
            
            // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
            const storedArticles = localStorage.getItem('diary_articles');
            const storedProfile = localStorage.getItem('diary_profile');
            
            if (storedArticles) {
                articles = JSON.parse(storedArticles);
                console.log('æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', Object.keys(articles).length, 'ä»¶');
            } else {
                // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã®ã¿ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
                console.log('ãƒ‡ãƒ¼ã‚¿ãŒãªã„ãŸã‚ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™');
                generateSampleData();
                saveData();
            }
            
            if (storedProfile) {
                profile = JSON.parse(storedProfile);
            }
            
            // ç”»é¢ã‚’æç”»
            renderDashboard();
            renderCalendar();
            renderNewEntry();
            
            console.log('åˆæœŸåŒ–å®Œäº†');
        }
        
        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
        function renderDashboard() {
            console.log('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æç”»é–‹å§‹...');
            const years = [2026, 2025, 2024];
            let html = '<div class="year-tabs">';
            html += years.map(y => 
                `<div class="year-tab ${y === currentYear ? 'active' : ''}" onclick="changeYear(${y})">${y}</div>`
            ).join('');
            html += '<div class="year-tab" style="border-style: dashed;" onclick="addYear()">+ å¹´ã‚’è¿½åŠ </div>';
            html += '</div>';
            
            html += '<div class="months-grid">';
            const monthNames = ['1æœˆ','2æœˆ','3æœˆ','4æœˆ','5æœˆ','6æœˆ','7æœˆ','8æœˆ','9æœˆ','10æœˆ','11æœˆ','12æœˆ'];
            
            for (let m = 1; m <= 12; m++) {
                const daysInMonth = new Date(currentYear, m, 0).getDate();
                const allDays = [];
                
                // ãã®æœˆã®ã™ã¹ã¦ã®æ—¥ä»˜ã‚’ç”Ÿæˆ
                for (let d = 1; d <= daysInMonth; d++) {
                    const dateKey = `${currentYear}-${String(m).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                    const art = articles[dateKey];
                    allDays.push({
                        date: dateKey,
                        day: d,
                        article: art,
                        hasEntry: art && art.status === 'published'
                    });
                }
                
                const display5 = allDays.slice(0, 5);
                const hasMore = allDays.length > 5;
                
                html += `<div class="month-box">`;
                html += `<div class="month-header">${monthNames[m-1]}</div>`;
                html += `<div class="date-list" id="month-list-${m}">`;
                
                // æœ€åˆã®5æ—¥ã‚’è¡¨ç¤º
                display5.forEach(({ date, day, article, hasEntry }) => {
                    const d = new Date(date);
                    const dow = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'][d.getDay()];
                    
                    if (hasEntry) {
                        const isDraft = article.status === 'draft';
                        const bgColor = isDraft ? 'background: #fff9e6; border-left-color: #feca57;' : '';
                        const icon = isDraft ? 'ğŸ“ ' : '';
                        html += `<div class="date-item has-entry" style="${bgColor}" onclick="showArticle('${date}')">`;
                        html += `<div class="date-label">${day}æ—¥(${dow})</div>`;
                        html += `<div class="date-title">${icon}${article.title}</div>`;
                        html += `</div>`;
                    } else {
                        html += `<div class="date-item no-entry">`;
                        html += `<div class="date-label">${day}æ—¥(${dow})</div>`;
                        html += `</div>`;
                    }
                });
                
                html += '</div>';
                
                // ã‚‚ã£ã¨è¦‹ã‚‹ãƒœã‚¿ãƒ³ã¨è¿½åŠ æ—¥ä»˜
                if (hasMore) {
                    html += `<div class="date-list hidden" id="month-extra-${m}">`;
                    allDays.slice(5).forEach(({ date, day, article, hasEntry }) => {
                        const d = new Date(date);
                        const dow = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'][d.getDay()];
                        
                        if (hasEntry) {
                            const isDraft = article.status === 'draft';
                            const bgColor = isDraft ? 'background: #fff9e6; border-left-color: #feca57;' : '';
                            const icon = isDraft ? 'ğŸ“ ' : '';
                            html += `<div class="date-item has-entry" style="${bgColor}" onclick="showArticle('${date}')">`;
                            html += `<div class="date-label">${day}æ—¥(${dow})</div>`;
                            html += `<div class="date-title">${icon}${article.title}</div>`;
                            html += `</div>`;
                        } else {
                            html += `<div class="date-item no-entry">`;
                            html += `<div class="date-label">${day}æ—¥(${dow})</div>`;
                            html += `</div>`;
                        }
                    });
                    html += '</div>';
                    html += `<button class="show-more-btn" id="month-btn-${m}" onclick="toggleMonth(${m})">â–¼ ã‚‚ã£ã¨è¦‹ã‚‹</button>`;
                }
                
                html += '</div>';
            }
            
            html += '</div>';
            document.getElementById('dashboard').innerHTML = html;
            console.log('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æç”»å®Œäº†');
        }
        
        // æœˆã®å±•é–‹/æŠ˜ã‚ŠãŸãŸã¿
        function toggleMonth(m) {
            const extra = document.getElementById(`month-extra-${m}`);
            const btn = document.getElementById(`month-btn-${m}`);
            if (extra.classList.contains('hidden')) {
                extra.classList.remove('hidden');
                btn.textContent = 'â–² é–‰ã˜ã‚‹';
            } else {
                extra.classList.add('hidden');
                btn.textContent = 'â–¼ ã‚‚ã£ã¨è¦‹ã‚‹';
            }
        }
        
        // å¹´ã®å¤‰æ›´
        function changeYear(y) {
            currentYear = y;
            renderDashboard();
        }
        
        // å¹´ã®è¿½åŠ 
        function addYear() {
            const y = prompt('è¿½åŠ ã™ã‚‹å¹´ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: 2027ï¼‰:');
            if (y && !isNaN(y)) {
                currentYear = parseInt(y);
                renderDashboard();
            }
        }
        
        // æ–°è¦è¨˜äº‹ä½œæˆ
        function showNewArticle() {
            const today = new Date();
            const dateKey = today.getFullYear() + '-' + 
                           String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                           String(today.getDate()).padStart(2, '0');
            showEditPage(dateKey, true);
        }
        
        // ç·¨é›†ãƒšãƒ¼ã‚¸è¡¨ç¤º
        function showEditPage(date, isNew) {
            const art = isNew ? {
                title: '',
                content: '',
                category: 'æ—¥å¸¸',
                tags: [],
                images: [],
                thumbnail: '',
                blocks: [] // æ–°æ–¹å¼
            } : articles[date];
            
            // ãƒ–ãƒ­ãƒƒã‚¯åˆæœŸåŒ–
            if (art.blocks && art.blocks.length > 0) {
                // æ–°æ–¹å¼: ãƒ–ãƒ­ãƒƒã‚¯ã‚’ãã®ã¾ã¾ä½¿ç”¨
                editBlocks = JSON.parse(JSON.stringify(art.blocks));
            } else if (art.content || (art.images && art.images.length > 0)) {
                // æ—§æ–¹å¼: contentã¨imagesã‚’ãƒ–ãƒ­ãƒƒã‚¯ã«å¤‰æ›
                editBlocks = [];
                if (art.content) {
                    editBlocks.push({ type: 'text', content: art.content });
                }
                if (art.images && art.images.length > 0) {
                    art.images.forEach(img => {
                        editBlocks.push({ type: 'image', data: img });
                    });
                }
            } else {
                // å®Œå…¨ã«æ–°è¦: ç©ºã®ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã§é–‹å§‹
                editBlocks = [{ type: 'text', content: '' }];
            }
            
            editImages = art.images ? [...art.images] : [];
            editThumbnail = art.thumbnail || '';
            
            let html = '<div class="page-container">';
            html += '<h2>' + (isNew ? 'æ–°è¦è¨˜äº‹ä½œæˆ' : 'è¨˜äº‹ã‚’ç·¨é›†') + '</h2>';
            
            html += '<div class="form-group">';
            html += '<label>æ—¥ä»˜ *</label>';
            html += '<input type="date" id="editDate" value="' + date + '">';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>ã‚¿ã‚¤ãƒˆãƒ« *</label>';
            html += '<input type="text" id="editTitle" value="' + art.title + '" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›...">';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>æœ¬æ–‡ã¨ç”»åƒï¼ˆãƒ–ãƒ­ãƒƒã‚¯å½¢å¼ï¼‰</label>';
            html += '<div id="blocksContainer" style="margin-top: 10px;"></div>';
            html += '<div style="margin-top: 15px; display: flex; gap: 10px;">';
            html += '<button type="button" class="btn" onclick="addTextBlock()">â• ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯è¿½åŠ </button>';
            html += '<button type="button" class="btn" onclick="addImageBlock()">ğŸ–¼ï¸ ç”»åƒãƒ–ãƒ­ãƒƒã‚¯è¿½åŠ </button>';
            html += '</div>';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>ã‚«ãƒ†ã‚´ãƒªãƒ¼</label>';
            html += '<select id="editCategory">';
            ['æ—¥å¸¸', 'ãŠå‡ºã‹ã‘', 'è¶£å‘³', 'é£Ÿäº‹', 'å‹é”', 'ä»•äº‹', 'å¥åº·'].forEach(cat => {
                html += '<option value="' + cat + '"' + (art.category === cat ? ' selected' : '') + '>' + cat + '</option>';
            });
            html += '</select>';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label>';
            html += '<input type="text" id="editTags" value="' + (art.tags || []).join(', ') + '" placeholder="ä¾‹: æ—¥å¸¸, æ€ã„å‡º">';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒ</label>';
            html += '<input type="file" id="thumbnailFile" accept="image/*" onchange="handleThumbnailUpload(event)">';
            html += '<div id="thumbnailPreview" style="margin-top:10px;"></div>';
            html += '</div>';
            
            html += '<div class="form-actions">';
            html += '<button class="btn btn-new" onclick="saveArticle(\'' + date + '\', ' + isNew + ', \'published\')">ğŸ’¾ ä¿å­˜ã—ã¦å…¬é–‹</button>';
            html += '<button class="btn" style="background: #feca57; color: #333; border-color: #feca57;" onclick="saveArticle(\'' + date + '\', ' + isNew + ', \'draft\')">ğŸ“ ä¸‹æ›¸ãä¿å­˜</button>';
            html += '<button class="btn" onclick="showDashboard()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>';
            html += '</div>';
            
            html += '</div>';
            
            document.getElementById('editPage').innerHTML = html;
            renderBlocks();
            updateThumbnailPreview();
            showPage('editPage');
        }
        
        // ãƒ–ãƒ­ãƒƒã‚¯æç”»
        function renderBlocks() {
            const container = document.getElementById('blocksContainer');
            if (!container) return;
            
            // æ—¢å­˜ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å†…å®¹ã‚’ä¿å­˜
            const textareas = document.querySelectorAll('[data-block-idx]');
            textareas.forEach((textarea) => {
                const blockIdx = parseInt(textarea.getAttribute('data-block-idx'));
                if (editBlocks[blockIdx] && editBlocks[blockIdx].type === 'text') {
                    editBlocks[blockIdx].content = textarea.value;
                }
            });
            
            container.innerHTML = '';
            
            editBlocks.forEach((block, idx) => {
                const blockDiv = document.createElement('div');
                blockDiv.style.cssText = 'background: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #e0e0e0;';
                
                let blockHTML = '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">';
                blockHTML += '<strong>' + (block.type === 'text' ? 'ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯' : 'ğŸ–¼ï¸ ç”»åƒãƒ–ãƒ­ãƒƒã‚¯') + '</strong>';
                blockHTML += '<div style="display: flex; gap: 5px;">';
                if (idx > 0) {
                    blockHTML += '<button type="button" class="btn" onclick="moveBlockUp(' + idx + ')" style="padding: 5px 10px; font-size: 12px;">â†‘</button>';
                }
                if (idx < editBlocks.length - 1) {
                    blockHTML += '<button type="button" class="btn" onclick="moveBlockDown(' + idx + ')" style="padding: 5px 10px; font-size: 12px;">â†“</button>';
                }
                blockHTML += '<button type="button" class="btn" onclick="removeBlock(' + idx + ')" style="padding: 5px 10px; font-size: 12px; background: #ff4757; color: white; border-color: #ff4757;">å‰Šé™¤</button>';
                blockHTML += '</div></div>';
                
                if (block.type === 'text') {
                    blockHTML += '<textarea data-block-idx="' + idx + '" style="width: 100%; min-height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; font-size: 14px; resize: vertical;" placeholder="ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›...">' + (block.content || '') + '</textarea>';
                } else if (block.type === 'image') {
                    if (block.data) {
                        blockHTML += '<img src="' + block.data + '" style="max-width: 100%; height: auto; border-radius: 4px; margin-top: 10px;">';
                    } else {
                        blockHTML += '<input type="file" accept="image/*" onchange="handleBlockImageUpload(event, ' + idx + ')" style="margin-top: 10px;">';
                    }
                }
                
                blockDiv.innerHTML = blockHTML;
                container.appendChild(blockDiv);
            });
        }
        
        // ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯è¿½åŠ 
        function addTextBlock() {
            editBlocks.push({ type: 'text', content: '' });
            renderBlocks();
        }
        
        // ç”»åƒãƒ–ãƒ­ãƒƒã‚¯è¿½åŠ 
        function addImageBlock() {
            editBlocks.push({ type: 'image', data: '' });
            renderBlocks();
        }
        
        // ãƒ–ãƒ­ãƒƒã‚¯å‰Šé™¤
        function removeBlock(idx) {
            if (confirm('ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                editBlocks.splice(idx, 1);
                if (editBlocks.length === 0) {
                    editBlocks.push({ type: 'text', content: '' });
                }
                renderBlocks();
            }
        }
        
        // ãƒ–ãƒ­ãƒƒã‚¯ä¸Šç§»å‹•
        function moveBlockUp(idx) {
            if (idx > 0) {
                [editBlocks[idx], editBlocks[idx - 1]] = [editBlocks[idx - 1], editBlocks[idx]];
                renderBlocks();
            }
        }
        
        // ãƒ–ãƒ­ãƒƒã‚¯ä¸‹ç§»å‹•
        function moveBlockDown(idx) {
            if (idx < editBlocks.length - 1) {
                [editBlocks[idx], editBlocks[idx + 1]] = [editBlocks[idx + 1], editBlocks[idx]];
                renderBlocks();
            }
        }
        
        // ãƒ–ãƒ­ãƒƒã‚¯ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        function handleBlockImageUpload(event, idx) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                editBlocks[idx].data = e.target.result;
                renderBlocks();
            };
            reader.readAsDataURL(file);
        }
        
        // ã‚µãƒ ãƒã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        function handleThumbnailUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                editThumbnail = e.target.result;
                updateThumbnailPreview();
            };
            reader.readAsDataURL(file);
        }
        
        // ã‚µãƒ ãƒã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
        function updateThumbnailPreview() {
            const preview = document.getElementById('thumbnailPreview');
            if (!preview) return;
            if (editThumbnail) {
                preview.innerHTML = '<img src="' + editThumbnail + '" style="width:120px;height:120px;object-fit:cover;border-radius:4px;">';
            } else {
                preview.innerHTML = '';
            }
        }
        
        // è¨˜äº‹ä¿å­˜
        function saveArticle(originalDate, isNew, saveStatus) {
            const newDate = document.getElementById('editDate').value;
            const title = document.getElementById('editTitle').value.trim();
            
            if (!newDate || !title) {
                alert('æ—¥ä»˜ã€ã‚¿ã‚¤ãƒˆãƒ«ã¯å¿…é ˆã§ã™');
                return;
            }
            
            // åŒã˜æ—¥ä»˜ã«æ—¢ã«è¨˜äº‹ãŒã‚ã‚‹å ´åˆã®ç¢ºèª
            if (articles[newDate] && newDate !== originalDate) {
                const existingArticle = articles[newDate];
                const statusText = existingArticle.status === 'draft' ? 'ä¸‹æ›¸ã' : 'è¨˜äº‹';
                
                if (saveStatus === 'draft') {
                    // ä¸‹æ›¸ãä¿å­˜ã®å ´åˆã€æ—¢å­˜ã®ä¸‹æ›¸ãã‚’é–‹ã
                    alert('ã“ã®æ—¥ä»˜ã«ã¯æ—¢ã«' + statusText + 'ãŒã‚ã‚Šã¾ã™ã€‚ç·¨é›†ç”»é¢ã‚’é–‹ãã¾ã™ã€‚');
                    showEditPage(newDate, false);
                    return;
                } else {
                    // å…¬é–‹ã®å ´åˆã€ä¸Šæ›¸ãç¢ºèª
                    if (!confirm('ã“ã®æ—¥ä»˜ã«ã¯æ—¢ã«' + statusText + 'ãŒã‚ã‚Šã¾ã™ã€‚ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ')) {
                        return;
                    }
                }
            }
            
            // ãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’åé›†
            const textareas = document.querySelectorAll('[data-block-idx]');
            textareas.forEach((textarea, idx) => {
                const blockIdx = parseInt(textarea.getAttribute('data-block-idx'));
                if (editBlocks[blockIdx] && editBlocks[blockIdx].type === 'text') {
                    editBlocks[blockIdx].content = textarea.value;
                }
            });
            
            // ç©ºã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‰Šé™¤
            const validBlocks = editBlocks.filter(block => {
                if (block.type === 'text') return block.content.trim() !== '';
                if (block.type === 'image') return block.data !== '';
                return false;
            });
            
            if (validBlocks.length === 0) {
                alert('æœ¬æ–‡ã¾ãŸã¯ç”»åƒã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            const category = document.getElementById('editCategory').value;
            const tags = document.getElementById('editTags').value
                .split(',')
                .map(t => t.trim())
                .filter(t => t);
            
            // æ—¥ä»˜ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€å…ƒã®è¨˜äº‹ã‚’å‰Šé™¤
            if (originalDate !== newDate && articles[originalDate]) {
                delete articles[originalDate];
            }
            
            // ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•è¨­å®šï¼ˆæœ€åˆã®ç”»åƒãƒ–ãƒ­ãƒƒã‚¯ï¼‰
            if (!editThumbnail) {
                const firstImageBlock = validBlocks.find(b => b.type === 'image');
                if (firstImageBlock) {
                    editThumbnail = firstImageBlock.data;
                }
            }
            
            // è¨˜äº‹ã‚’ä¿å­˜ï¼ˆæ–°æ–¹å¼ï¼‰
            articles[newDate] = {
                title,
                blocks: validBlocks,
                timestamp: (articles[originalDate] && !isNew) ? articles[originalDate].timestamp : Date.now(),
                category,
                tags,
                thumbnail: editThumbnail,
                status: saveStatus || 'published',
                comments: (articles[originalDate] && !isNew) ? articles[originalDate].comments : [],
                // å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ä¿æŒ
                content: validBlocks.filter(b => b.type === 'text').map(b => b.content).join('\n\n'),
                images: validBlocks.filter(b => b.type === 'image').map(b => b.data)
            };
            
            saveData();
            renderDashboard();
            renderNewEntry();
            showArticle(newDate);
        }
        
        // è¨˜äº‹è¡¨ç¤º
        function showArticle(date) {
            const art = articles[date];
            if (!art) {
                if (confirm(`${date}ã®è¨˜äº‹ã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ`)) {
                    showEditPage(date, true);
                }
                return;
            }
            
            // å‰å¾Œã®è¨˜äº‹ã‚’å–å¾—
            const all = Object.keys(articles)
                .filter(d => articles[d].status === 'published')
                .sort();
            const idx = all.indexOf(date);
            const prev = idx > 0 ? all[idx - 1] : null;
            const next = idx < all.length - 1 ? all[idx + 1] : null;
            
            let html = '<div class="page-container">';
            
            // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
            html += '<div class="article-nav">';
            if (prev) {
                html += `<a href="javascript:void(0)" class="nav-link" onclick="showArticle('${prev}')">â† ${articles[prev].title}</a>`;
            } else {
                html += '<div></div>';
            }
            html += `<a href="javascript:void(0)" class="nav-link" onclick="showDashboard()">æˆ»ã‚‹</a>`;
            if (next) {
                html += `<a href="javascript:void(0)" class="nav-link" onclick="showArticle('${next}')">${articles[next].title} â†’</a>`;
            } else {
                html += '<div></div>';
            }
            html += '</div>';
            
            // è¨˜äº‹ãƒ˜ãƒƒãƒ€ãƒ¼
            html += '<div class="article-header">';
            if (art.status === 'draft') {
                html += '<div style="display: inline-block; background: #fff9e6; color: #f39c12; padding: 5px 15px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-bottom: 10px;">ğŸ“ ä¸‹æ›¸ã</div>';
            }
            html += '<h2 class="article-title">' + art.title + '</h2>';
            html += '<div class="article-meta">';
            html += '<span>ğŸ“… è¨˜äº‹æ—¥ä»˜: ' + date + '</span>';
            html += '<span>ğŸ•’ æŠ•ç¨¿æ—¥æ™‚: ' + new Date(art.timestamp).toLocaleString('ja-JP', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            }) + '</span>';
            html += '<span>ğŸ“ ' + art.category + '</span>';
            html += '<button class="btn" onclick="showEditPage(\'' + date + '\', false)">âœï¸ ç·¨é›†</button>';
            html += '</div>';
            html += '</div>';
            
            // è¨˜äº‹æœ¬æ–‡
            html += '<div class="article-content">';
            
            // æ–°æ–¹å¼ï¼ˆãƒ–ãƒ­ãƒƒã‚¯ï¼‰ã§è¡¨ç¤º
            if (art.blocks && art.blocks.length > 0) {
                art.blocks.forEach(block => {
                    if (block.type === 'text') {
                        html += block.content.split('\n').map(p => '<p>' + p + '</p>').join('');
                    } else if (block.type === 'image' && block.data) {
                        html += '<img src="' + block.data + '">';
                    }
                });
            } else {
                // æ—§æ–¹å¼ï¼ˆæ—¢å­˜40ä»¶ç”¨ï¼‰
                html += art.content.split('\n').map(p => '<p>' + p + '</p>').join('');
                
                // ç”»åƒ
                if (art.images && art.images.length > 0) {
                    html += art.images.map(img => '<img src="' + img + '">').join('');
                }
            }
            
            // ã‚¿ã‚°
            if (art.tags && art.tags.length > 0) {
                html += '<div class="article-tags">';
                html += art.tags.map(t => '<span class="tag">#' + t + '</span>').join('');
                html += '</div>';
            }
            html += '</div>';
            
            // ã‚³ãƒ¡ãƒ³ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³
            html += '<div class="comments-section">';
            html += '<h3 class="comments-title">ğŸ’¬ ã‚³ãƒ¡ãƒ³ãƒˆ</h3>';
            html += '<div class="comment-form">';
            html += '<textarea id="commentText" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›..."></textarea>';
            html += '<button class="btn" onclick="addComment(\'' + date + '\')">ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿</button>';
            html += '</div>';
            
            if (art.comments && art.comments.length > 0) {
                html += art.comments.map(c => 
                    '<div class="comment-item">' +
                    '<div class="comment-meta">' + new Date(c.timestamp).toLocaleString('ja-JP') + '</div>' +
                    '<div class="comment-text">' + c.text + '</div>' +
                    '</div>'
                ).join('');
            }
            
            html += '</div>';
            html += '</div>';
            
            document.getElementById('articlePage').innerHTML = html;
            showPage('articlePage');
        }
        
        // ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
        function addComment(date) {
            const text = document.getElementById('commentText').value.trim();
            if (!text) {
                alert('ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            if (!articles[date].comments) {
                articles[date].comments = [];
            }
            
            articles[date].comments.push({
                text: text,
                timestamp: Date.now()
            });
            
            saveData();
            showArticle(date);
        }
        
        // è¨˜äº‹ä¸€è¦§è¡¨ç¤ºï¼ˆæ¤œç´¢çµæœå¯¾å¿œç‰ˆï¼‰
        let searchQuery = ''; // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã§æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä¿æŒ
        
        function showArticlesList(page = 1, query = '') {
            searchQuery = query; // æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä¿å­˜
            
            let all = Object.entries(articles)
                .filter(([_, a]) => a.status === 'published');
            
            // æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            if (query) {
                all = all.filter(([_, a]) => 
                    a.title.toLowerCase().includes(query.toLowerCase()) || 
                    a.content.toLowerCase().includes(query.toLowerCase()) || 
                    (a.tags && a.tags.some(t => t.toLowerCase().includes(query.toLowerCase())))
                );
            }
            
            all = all.sort((a, b) => b[0].localeCompare(a[0]));
            
            const perPage = 10;
            const total = Math.ceil(all.length / perPage);
            const items = all.slice((page - 1) * perPage, page * perPage);
            
            let html = '<div class="page-container">';
            const title = query ? `æ¤œç´¢çµæœ: "${query}"` : 'ã™ã¹ã¦ã®è¨˜äº‹';
            html += '<h2 style="font-size: 24px; margin-bottom: 30px;">' + title + '</h2>';
            
            if (all.length === 0) {
                html += '<div style="text-align: center; padding: 40px; color: #999;">è©²å½“ã™ã‚‹è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div></div>';
                document.getElementById('listPage').innerHTML = html;
                showPage('listPage');
                return;
            }
            html += '<div class="articles-list">';
            
            items.forEach(([date, art]) => {
                const excerpt = art.content.substring(0, 100) + (art.content.length > 100 ? '...' : '');
                html += `<div class="article-card" onclick="showArticle('${date}')">`;
                html += `<img src="${art.thumbnail || 'https://via.placeholder.com/120'}" class="article-thumbnail">`;
                html += '<div class="article-info">';
                html += '<h3 class="article-list-title">' + art.title + '</h3>';
                html += '<div class="article-excerpt">' + excerpt + '</div>';
                html += '<div class="article-meta">';
                html += '<span>ğŸ“… ' + date + '</span>'; // æŒ‡å®šæ—¥ä»˜ã‚’è¡¨ç¤º
                html += '<span>ğŸ“ ' + art.category + '</span>';
                html += '</div>';
                html += '</div>';
                html += '</div>';
            });
            
            html += '</div>';
            
            // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
            if (total > 1) {
                html += '<div class="pagination">';
                for (let p = 1; p <= total; p++) {
                    html += `<button class="page-btn ${p === page ? 'active' : ''}" onclick="showArticlesList(${p}, '${query}')">${p}</button>`;
                }
                html += '</div>';
            }
            
            html += '</div>';
            
            document.getElementById('listPage').innerHTML = html;
            showPage('listPage');
        }
        
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸è¡¨ç¤º
        function showProfilePage() {
            console.log('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¾ã™');
            
            let html = '<div class="page-container">';
            html += '<h2 style="text-align:center;margin-bottom:30px;">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</h2>';
            html += '<div class="profile-content">';
            
            // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚»ã‚¯ã‚·ãƒ§ãƒ³
            html += '<div class="profile-image-section">';
            html += '<img src="' + profile.photo + '" class="profile-large-img">';
            html += '<button class="btn" onclick="editProfile()">ç·¨é›†</button>';
            html += '</div>';
            
            // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è©³ç´°
            html += '<div class="profile-details">';
            html += '<h3 class="profile-name-large">' + profile.name + '</h3>';
            
            html += '<div class="profile-item">';
            html += '<div class="profile-label">Birthday</div>';
            html += '<div class="profile-value">' + new Date(profile.birthday).toLocaleDateString('ja-JP') + '</div>';
            html += '</div>';
            
            html += '<div class="profile-item">';
            html += '<div class="profile-label">Blood type</div>';
            html += '<div class="profile-value">' + profile.bloodType + '</div>';
            html += '</div>';
            
            html += '<div class="profile-item">';
            html += '<div class="profile-label">æ˜Ÿåº§</div>';
            html += '<div class="profile-value">' + profile.zodiac + '</div>';
            html += '</div>';
            
            html += '<div class="profile-item">';
            html += '<div class="profile-label">èº«é•·</div>';
            html += '<div class="profile-value">' + profile.height + 'cm</div>';
            html += '</div>';
            
            // ã‚«ã‚¹ã‚¿ãƒ é …ç›®
            if (profile.custom && profile.custom.length > 0) {
                profile.custom.forEach(item => {
                    html += '<div class="profile-item">';
                    html += '<div class="profile-label">' + item.label + '</div>';
                    html += '<div class="profile-value">' + item.value + '</div>';
                    html += '</div>';
                });
            }
            
            html += '</div>';
            html += '</div>';
            html += '</div>';
            
            document.getElementById('profilePage').innerHTML = html;
            showPage('profilePage');
        }
        
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ç”»é¢è¡¨ç¤º
        let editProfilePhoto = ''; // ç·¨é›†ä¸­ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†™çœŸã‚’ä¿æŒ
        
        function editProfile() {
            editProfilePhoto = profile.photo; // ç¾åœ¨ã®å†™çœŸã‚’ã‚»ãƒƒãƒˆ
            
            let html = '<div class="page-container">';
            html += '<h2 style="text-align:center;margin-bottom:30px;">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</h2>';
            
            html += '<div class="form-group">';
            html += '<label>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†™çœŸ</label>';
            html += '<input type="file" id="editPhotoFile" accept="image/*" onchange="handleProfilePhotoUpload(event)">';
            html += '<div id="profilePhotoPreview" style="margin-top: 10px;"></div>';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>åå‰ *</label>';
            html += '<input type="text" id="editName" value="' + profile.name + '" placeholder="åå‰ã‚’å…¥åŠ›">';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>èª•ç”Ÿæ—¥</label>';
            html += '<input type="date" id="editBirthday" value="' + profile.birthday + '">';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>è¡€æ¶²å‹</label>';
            html += '<select id="editBloodType">';
            ['A', 'B', 'O', 'AB'].forEach(type => {
                html += '<option value="' + type + '"' + (profile.bloodType === type ? ' selected' : '') + '>' + type + '</option>';
            });
            html += '</select>';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>æ˜Ÿåº§</label>';
            html += '<input type="text" id="editZodiac" value="' + profile.zodiac + '" placeholder="ä¾‹: ãŠã†ã—åº§">';
            html += '</div>';
            
            html += '<div class="form-group">';
            html += '<label>èº«é•·ï¼ˆcmï¼‰</label>';
            html += '<input type="number" id="editHeight" value="' + profile.height + '" placeholder="ä¾‹: 160">';
            html += '</div>';
            
            html += '<h3 style="margin-top: 30px; margin-bottom: 15px; font-size: 18px;">ã‚«ã‚¹ã‚¿ãƒ é …ç›®</h3>';
            html += '<div id="customFieldsContainer">';
            
            // æ—¢å­˜ã®ã‚«ã‚¹ã‚¿ãƒ é …ç›®
            if (profile.custom && profile.custom.length > 0) {
                profile.custom.forEach((item, idx) => {
                    html += '<div class="custom-field-item" style="display: flex; gap: 10px; margin-bottom: 10px;">';
                    html += '<input type="text" placeholder="é …ç›®å" value="' + item.label + '" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" data-custom-label="' + idx + '">';
                    html += '<input type="text" placeholder="å†…å®¹" value="' + item.value + '" style="flex: 2; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" data-custom-value="' + idx + '">';
                    html += '<button class="btn" onclick="removeCustomField(' + idx + ')" style="background: #ff4757; color: white; border-color: #ff4757;">å‰Šé™¤</button>';
                    html += '</div>';
                });
            }
            
            html += '</div>';
            html += '<button class="btn" onclick="addCustomField()" style="margin-top: 10px;">+ ã‚«ã‚¹ã‚¿ãƒ é …ç›®ã‚’è¿½åŠ </button>';
            
            html += '<div class="form-actions" style="margin-top: 30px;">';
            html += '<button class="btn btn-new" onclick="saveProfile()">ğŸ’¾ ä¿å­˜</button>';
            html += '<button class="btn" onclick="showProfilePage()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>';
            html += '</div>';
            
            html += '</div>';
            
            document.getElementById('profilePage').innerHTML = html;
            updateProfilePhotoPreview(); // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
            showPage('profilePage');
        }
        
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
        function handleProfilePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                editProfilePhoto = e.target.result;
                updateProfilePhotoPreview();
            };
            reader.readAsDataURL(file);
        }
        
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†™çœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
        function updateProfilePhotoPreview() {
            const preview = document.getElementById('profilePhotoPreview');
            if (!preview) return;
            
            if (editProfilePhoto) {
                preview.innerHTML = '<img src="' + editProfilePhoto + '" style="width:150px;height:150px;object-fit:cover;border-radius:50%;">';
            } else {
                preview.innerHTML = '';
            }
        }
        
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
        function addCustomField() {
            const container = document.getElementById('customFieldsContainer');
            const idx = container.children.length;
            
            const div = document.createElement('div');
            div.className = 'custom-field-item';
            div.style.cssText = 'display: flex; gap: 10px; margin-bottom: 10px;';
            
            div.innerHTML = `
                <input type="text" placeholder="é …ç›®å" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" data-custom-label="${idx}">
                <input type="text" placeholder="å†…å®¹" style="flex: 2; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" data-custom-value="${idx}">
                <button class="btn" onclick="removeCustomFieldElement(this)" style="background: #ff4757; color: white; border-color: #ff4757;">å‰Šé™¤</button>
            `;
            
            container.appendChild(div);
        }
        
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‰Šé™¤ï¼ˆDOMè¦ç´ ï¼‰
        function removeCustomFieldElement(btn) {
            btn.parentElement.remove();
        }
        
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‰Šé™¤ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ï¼‰
        function removeCustomField(idx) {
            if (confirm('ã“ã®é …ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                profile.custom.splice(idx, 1);
                editProfile();
            }
        }
        
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜
        function saveProfile() {
            const name = document.getElementById('editName').value.trim();
            const birthday = document.getElementById('editBirthday').value;
            const bloodType = document.getElementById('editBloodType').value;
            const zodiac = document.getElementById('editZodiac').value.trim();
            const height = document.getElementById('editHeight').value.trim();
            
            if (!name) {
                alert('åå‰ã¯å¿…é ˆã§ã™');
                return;
            }
            
            // ã‚«ã‚¹ã‚¿ãƒ é …ç›®ã‚’åé›†
            const customFields = [];
            const container = document.getElementById('customFieldsContainer');
            const items = container.querySelectorAll('.custom-field-item');
            
            items.forEach((item, idx) => {
                const labelInput = item.querySelector(`[data-custom-label]`);
                const valueInput = item.querySelector(`[data-custom-value]`);
                
                if (labelInput && valueInput) {
                    const label = labelInput.value.trim();
                    const value = valueInput.value.trim();
                    
                    if (label && value) {
                        customFields.push({ label, value });
                    }
                }
            });
            
            // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°
            profile.photo = editProfilePhoto; // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã‚’ä½¿ç”¨
            profile.name = name;
            profile.birthday = birthday;
            profile.bloodType = bloodType;
            profile.zodiac = zodiac;
            profile.height = height;
            profile.custom = customFields;
            
            // ä¿å­˜
            localStorage.setItem('diary_profile', JSON.stringify(profile));
            
            // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®åå‰ã¨å†™çœŸã‚‚æ›´æ–°
            document.querySelector('.profile-name').textContent = name;
            document.querySelector('.profile-img').src = editProfilePhoto;
            
            alert('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            showProfilePage();
        }
        
        // æ¤œç´¢æ©Ÿèƒ½
        function searchArticles() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) {
                alert('æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            // æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¸¡ã—ã¦è¨˜äº‹ä¸€è¦§ã‚’è¡¨ç¤º
            showArticlesList(1, query);
        }
        
        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º
        function renderCalendar() {
            const year = currentYear;
            const month = currentMonth;
            const firstDay = new Date(year, month, 1).getDay();
            const days = new Date(year, month + 1, 0).getDate();
            
            document.getElementById('calendarMonth').textContent = year + 'å¹´' + (month + 1) + 'æœˆ';
            
            let html = '';
            
            // å‰æœˆã®æ—¥ä»˜
            const prevDays = new Date(year, month, 0).getDate();
            for (let i = firstDay - 1; i >= 0; i--) {
                html += '<div class="calendar-day other-month">' + (prevDays - i) + '</div>';
            }
            
            // å½“æœˆã®æ—¥ä»˜
            for (let d = 1; d <= days; d++) {
                const key = year + '-' + String(month + 1).padStart(2, '0') + '-' + String(d).padStart(2, '0');
                const has = articles[key] && articles[key].status === 'published';
                const hasDraft = articles[key] && articles[key].status === 'draft';
                
                if (has) {
                    html += '<div class="calendar-day has-entry" onclick="showArticle(\'' + key + '\')">' + d + '</div>';
                } else if (hasDraft) {
                    html += '<div class="calendar-day" style="background: #feca57; color: white; font-weight: 600; cursor: pointer;" onclick="showArticle(\'' + key + '\')">' + d + '</div>';
                } else {
                    html += '<div class="calendar-day">' + d + '</div>';
                }
            }
            
            // æ¬¡æœˆã®æ—¥ä»˜
            const remain = 42 - (firstDay + days);
            for (let d = 1; d <= remain; d++) {
                html += '<div class="calendar-day other-month">' + d + '</div>';
            }
            
            document.getElementById('calendarGrid').innerHTML = html;
        }
        
        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœˆç§»å‹•
        function prevMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }
        
        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }
        
        // æœ€æ–°è¨˜äº‹è¡¨ç¤º
        function renderNewEntry() {
            const all = Object.entries(articles)
                .filter(([_, a]) => a.status === 'published')
                .sort((a, b) => b[0].localeCompare(a[0]))
                .slice(0, 5);
            
            if (all.length === 0) {
                document.getElementById('newEntryList').innerHTML = 
                    '<div style="text-align:center;color:#999;padding:20px 0;">è¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                return;
            }
            
            const html = all.map(([d, a]) => 
                '<div class="entry-item" onclick="showArticle(\'' + d + '\')">' +
                '<div class="entry-date">' + d + '</div>' +
                '<div class="entry-title">' + a.title + '</div>' +
                '</div>'
            ).join('');
            
            document.getElementById('newEntryList').innerHTML = html;
        }
        
        // ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ
        function showPage(id) {
            ['dashboard', 'articlePage', 'editPage', 'listPage', 'profilePage'].forEach(p => {
                document.getElementById(p).classList.add('hidden');
            });
            document.getElementById(id).classList.remove('hidden');
            window.scrollTo(0, 0);
        }
        
        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹
        function showDashboard() {
            renderDashboard();
            renderNewEntry();
            renderCalendar();
            showPage('dashboard');
        }
        
        // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        function saveData() {
            localStorage.setItem('diary_articles', JSON.stringify(articles));
        }
        
        // ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        function exportData() {
            const data = {
                articles: articles,
                profile: profile,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'diary_backup_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        function importData() {
            document.getElementById('importFile').click();
        }
        
        document.getElementById('importFile').onchange = function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(ev) {
                try {
                    const data = JSON.parse(ev.target.result);
                    articles = data.articles;
                    profile = data.profile;
                    saveData();
                    localStorage.setItem('diary_profile', JSON.stringify(profile));
                    init();
                    alert('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸï¼');
                } catch (error) {
                    console.error('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                    alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            };
            reader.readAsText(file);
        };
        
        // åˆæœŸåŒ–å®Ÿè¡Œ
        init();
    </script>
</body>
</html>
